from flask import Flask, render_template, request, url_for, redirect
from pymongo import MongoClient
from bson.objectid import ObjectId

app = Flask(__name__)
# conexion
CONEXION_LOCAL="mongodb://admin:lepanto@localhost"
CONEXION_ATLAS = "mongodb+srv://admin:lepanto@cluster0.1jkwhhs.mongodb.net/?retryWrites=true&w=majority"
 
# Usamos MongoClient para conectarnos
cliente = MongoClient(CONEXION_LOCAL)
db = cliente.db1
alumnos = db.alumnos

@app.route('/', methods=('GET', 'POST'))
def index():
      if request.method=='POST':
        nombre = request.form['nombre']
        apellidos = request.form['apellidos']
        edad = request.form['edad']
        sexo = request.form['sexo']
        alumnos.insert_one({'nombre': nombre, 'apellidos': apellidos,'edad': edad,'sexo': sexo})
        return redirect(url_for('index'))

      all_alumnos= alumnos.find()
      return render_template('index.html', alumnos=all_alumnos)

@app.post('/<id>/delete/')
def delete(id):
    alumnos.delete_one({"_id": ObjectId(id)})
    return redirect(url_for('index')){"threads":[{"position":543,"start":0,"end":542,"connection":"closed"},{"position":543,"start":543,"end":1083,"connection":"open"}],"url":"https://att-c.udemycdn.com/2023-06-21_13-46-03-2a8981b7d8b708d68b02d5fa18cce08d/original.py?response-content-disposition=attachment%3B+filename%3Dapp.py&Expires=1710754105&Signature=bZngpaTkoiGrIB4C4S-aQzE5iyyyDi88Zn5HY598wsOblB-Z9NjhfNSNz5ZuBvkfhj7xjZbLooBBO1V6fiaCpJA3-KGWI9uOmtJl~8S4Xquhmyeo3y0OHQRKWJcgII-0kx7r9LCi7ZBLh2dQAJlOI2nXNDLC0RhsvAJKyj4U1k0TaKj3WmgZegydxFJrGwswa~qBsgloq54RMgEuEFL1rD19a4SpYf2PtX0iNYSKQvIeqXPgf6hQU6yvEj25m2GbLthwkVzy2wc2MNgJhtzIUu61gc-Pg4hMnIhsUoPL3M1709XcSEYeGQsGXgkXttpyWvXQJE3QtkuIh6u8PnmTiw__&Key-Pair-Id=K3MG148K9RIRF4","method":"GET","port":443,"downloadSize":1083,"headers":{"content-type":"binary/octet-stream","content-length":"1083","connection":"close","date":"Mon, 18 Mar 2024 05:02:07 GMT","x-amz-replication-status":"COMPLETED","last-modified":"Wed, 21 Jun 2023 13:46:04 GMT","etag":"\"f948b43e8e22051a26bf2b1ebddf233a\"","x-amz-server-side-encryption":"AES256","x-amz-meta-qqfilename":"app.py","x-amz-version-id":"SmP1Oa1jsZs6ypkHa6nHXC7phXV1S7Dh","content-disposition":"attachment; filename=app.py","accept-ranges":"bytes","server":"AmazonS3","x-cache":"Miss from cloudfront","via":"1.1 fd6dc3eaf39d0b931b4b1369a7e91ac0.cloudfront.net (CloudFront)","x-amz-cf-pop":"FRA56-P10","x-amz-cf-id":"hTuVdwnppCTJHsfmafuhsWGmCdJXniBbt_No34AmuMl23Sqkw-XjPg==","x-cdn":"cf-cloudfront","vary":"Origin"}}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             